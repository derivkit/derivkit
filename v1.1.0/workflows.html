<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html"><link rel="search" title="Search" href="search.html"><link rel="next" title="Citation" href="citation.html"><link rel="prev" title="Poissonian Likelihood" href="examples/likelihoods/poissonian.html">
        <link rel="prefetch" href="_static/logos/logo-black.png" as="image">
        <link rel="prefetch" href="_static/logos/logo-blue.png" as="image">

    <link rel="shortcut icon" href="_static/favicon.png"><!-- Generated with Sphinx 8.2.3 and Furo 2025.12.19 -->
        <title>Workflows - DerivKit documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=d111a655" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=7bdb33bb" />
    <link rel="stylesheet" type="text/css" href="_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=8dab3a3b" />
    <link rel="stylesheet" type="text/css" href="_static/derivkit.css?v=805b2b8a" />
    
    


<style>
  body {
    --color-code-background: #f2f2f2;
  --color-code-foreground: #1e1e1e;
  --color-brand-primary: #3b9ab2;
  --color-brand-content: #3b9ab2;
  --color-link: #3b9ab2;
  --color-link--hover: #f21901;
  --color-link--visited: #e1af00;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #3b9ab2;
  --color-brand-content: #3b9ab2;
  --color-link: #3b9ab2;
  --color-link--hover: #f21901;
  --color-link--visited: #e1af00;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #3b9ab2;
  --color-brand-content: #3b9ab2;
  --color-link: #3b9ab2;
  --color-link--hover: #f21901;
  --color-link--visited: #e1af00;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle site navigation sidebar">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc" aria-label="Toggle table of contents sidebar">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <span class="icon"><svg><use href="#svg-menu"></use></svg></span>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">DerivKit  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="_static/logos/logo-black.png" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="_static/logos/logo-blue.png" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text">DerivKit  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="about/index.html"> About</a><input aria-label="Toggle navigation of  About" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="about/overview.html">What is DerivKit?</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="about/kits/index.html"> Kits</a><input aria-label="Toggle navigation of  Kits" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="about/kits/derivative_kit.html"> DerivativeKit</a></li>
<li class="toctree-l3"><a class="reference internal" href="about/kits/calculus_kit.html"> CalculusKit</a></li>
<li class="toctree-l3"><a class="reference internal" href="about/kits/forecast_kit.html"> ForecastKit</a></li>
<li class="toctree-l3"><a class="reference internal" href="about/kits/likelihood_kit.html"> LikelihoodKit</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="installation.html"> Installation</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="examples/index.html"> Examples</a><input aria-label="Toggle navigation of  Examples" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="examples/derivatives/index.html"> Derivatives</a><input aria-label="Toggle navigation of  Derivatives" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="examples/derivatives/finite_differences.html"> Finite differences</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/derivatives/adaptive_fit.html"> Adaptive polynomial fit</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/derivatives/local_poly.html"> Local polynomial fit</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/derivatives/tabulated.html"> Tabulated derivatives</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/derivatives/multiple_points.html"> Derivatives at multiple points</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="examples/calculus/index.html"> Calculus</a><input aria-label="Toggle navigation of  Calculus" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="examples/calculus/gradient.html"> Gradient</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/calculus/jacobian.html"> Jacobian</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/calculus/hessian.html"> Hessian</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/calculus/hyperhessian.html"> Hyper-Hessian</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="examples/forecasting/index.html"> Forecasting</a><input aria-label="Toggle navigation of  Forecasting" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="examples/forecasting/fisher.html"> Fisher matrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/forecasting/fisher_bias.html"> Fisher bias</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/forecasting/dali.html"> DALI tensors</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/forecasting/fisher_contours.html"> Fisher contours</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/forecasting/dali_contours.html"> DALI contours</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/forecasting/laplace_approx.html"> Laplace approximation</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/forecasting/laplace_contours.html"> Laplace contours</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/forecasting/fisher_gauss.html"> Gaussian Fisher matrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/forecasting/fisher_xy.html"> X–Y Gaussian Fisher matrix</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="examples/likelihoods/index.html"> Likelihoods</a><input aria-label="Toggle navigation of  Likelihoods" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="examples/likelihoods/gaussian.html"> Gaussian Likelihood</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/likelihoods/poissonian.html"> Poissonian Likelihood</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#"> Workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="citation.html"> Citation</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html"> Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="team.html"> Team</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html"> License</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="api/index.html">derivkit API</a><input aria-label="Toggle navigation of derivkit API" class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="api/derivkit.html">derivkit package</a><input aria-label="Toggle navigation of derivkit package" class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="api/derivkit.calculus.html">derivkit.calculus package</a><input aria-label="Toggle navigation of derivkit.calculus package" class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l4"><a class="reference internal" href="api/derivkit.calculus.calculus_core.html">derivkit.calculus.calculus_core module</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/derivkit.calculus.gradient.html">derivkit.calculus.gradient module</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/derivkit.calculus.hessian.html">derivkit.calculus.hessian module</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/derivkit.calculus.hyper_hessian.html">derivkit.calculus.hyper_hessian module</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/derivkit.calculus.jacobian.html">derivkit.calculus.jacobian module</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="api/derivkit.derivatives.html">derivkit.derivatives package</a><input aria-label="Toggle navigation of derivkit.derivatives package" class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l4 has-children"><a class="reference internal" href="api/derivkit.derivatives.adaptive.html">derivkit.derivatives.adaptive package</a><input aria-label="Toggle navigation of derivkit.derivatives.adaptive package" class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l5"><a class="reference internal" href="api/derivkit.derivatives.adaptive.adaptive_fit.html">derivkit.derivatives.adaptive.adaptive_fit module</a></li>
<li class="toctree-l5"><a class="reference internal" href="api/derivkit.derivatives.adaptive.batch_eval.html">derivkit.derivatives.adaptive.batch_eval module</a></li>
<li class="toctree-l5"><a class="reference internal" href="api/derivkit.derivatives.adaptive.diagnostics.html">derivkit.derivatives.adaptive.diagnostics module</a></li>
<li class="toctree-l5"><a class="reference internal" href="api/derivkit.derivatives.adaptive.grid.html">derivkit.derivatives.adaptive.grid module</a></li>
<li class="toctree-l5"><a class="reference internal" href="api/derivkit.derivatives.adaptive.polyfit_utils.html">derivkit.derivatives.adaptive.polyfit_utils module</a></li>
<li class="toctree-l5"><a class="reference internal" href="api/derivkit.derivatives.adaptive.spacing.html">derivkit.derivatives.adaptive.spacing module</a></li>
<li class="toctree-l5"><a class="reference internal" href="api/derivkit.derivatives.adaptive.transforms.html">derivkit.derivatives.adaptive.transforms module</a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="api/derivkit.derivatives.autodiff.html">derivkit.derivatives.autodiff package</a><input aria-label="Toggle navigation of derivkit.derivatives.autodiff package" class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l5"><a class="reference internal" href="api/derivkit.derivatives.autodiff.jax_autodiff.html">derivkit.derivatives.autodiff.jax_autodiff module</a></li>
<li class="toctree-l5"><a class="reference internal" href="api/derivkit.derivatives.autodiff.jax_core.html">derivkit.derivatives.autodiff.jax_core module</a></li>
<li class="toctree-l5"><a class="reference internal" href="api/derivkit.derivatives.autodiff.jax_utils.html">derivkit.derivatives.autodiff.jax_utils module</a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="api/derivkit.derivatives.finite.html">derivkit.derivatives.finite package</a><input aria-label="Toggle navigation of derivkit.derivatives.finite package" class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l5"><a class="reference internal" href="api/derivkit.derivatives.finite.batch_eval.html">derivkit.derivatives.finite.batch_eval module</a></li>
<li class="toctree-l5"><a class="reference internal" href="api/derivkit.derivatives.finite.core.html">derivkit.derivatives.finite.core module</a></li>
<li class="toctree-l5"><a class="reference internal" href="api/derivkit.derivatives.finite.extrapolators.html">derivkit.derivatives.finite.extrapolators module</a></li>
<li class="toctree-l5"><a class="reference internal" href="api/derivkit.derivatives.finite.finite_difference.html">derivkit.derivatives.finite.finite_difference module</a></li>
<li class="toctree-l5"><a class="reference internal" href="api/derivkit.derivatives.finite.stencil.html">derivkit.derivatives.finite.stencil module</a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="api/derivkit.derivatives.local_polynomial_derivative.html">derivkit.derivatives.local_polynomial_derivative package</a><input aria-label="Toggle navigation of derivkit.derivatives.local_polynomial_derivative package" class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l5"><a class="reference internal" href="api/derivkit.derivatives.local_polynomial_derivative.diagnostics.html">derivkit.derivatives.local_polynomial_derivative.diagnostics module</a></li>
<li class="toctree-l5"><a class="reference internal" href="api/derivkit.derivatives.local_polynomial_derivative.fit.html">derivkit.derivatives.local_polynomial_derivative.fit module</a></li>
<li class="toctree-l5"><a class="reference internal" href="api/derivkit.derivatives.local_polynomial_derivative.local_poly_config.html">derivkit.derivatives.local_polynomial_derivative.local_poly_config module</a></li>
<li class="toctree-l5"><a class="reference internal" href="api/derivkit.derivatives.local_polynomial_derivative.local_polynomial_derivative.html">derivkit.derivatives.local_polynomial_derivative.local_polynomial_derivative module</a></li>
<li class="toctree-l5"><a class="reference internal" href="api/derivkit.derivatives.local_polynomial_derivative.sampling.html">derivkit.derivatives.local_polynomial_derivative.sampling module</a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="api/derivkit.derivatives.tabulated_model.html">derivkit.derivatives.tabulated_model package</a><input aria-label="Toggle navigation of derivkit.derivatives.tabulated_model package" class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l5"><a class="reference internal" href="api/derivkit.derivatives.tabulated_model.one_d.html">derivkit.derivatives.tabulated_model.one_d module</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="api/derivkit.derivatives.fornberg.html">derivkit.derivatives.fornberg module</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="api/derivkit.forecasting.html">derivkit.forecasting package</a><input aria-label="Toggle navigation of derivkit.forecasting package" class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l4"><a class="reference internal" href="api/derivkit.forecasting.dali.html">derivkit.forecasting.dali module</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/derivkit.forecasting.expansions.html">derivkit.forecasting.expansions module</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/derivkit.forecasting.fisher.html">derivkit.forecasting.fisher module</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/derivkit.forecasting.fisher_gaussian.html">derivkit.forecasting.fisher_gaussian module</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/derivkit.forecasting.fisher_xy.html">derivkit.forecasting.fisher_xy module</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/derivkit.forecasting.forecast_core.html">derivkit.forecasting.forecast_core module</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/derivkit.forecasting.getdist_dali_samples.html">derivkit.forecasting.getdist_dali_samples module</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/derivkit.forecasting.getdist_fisher_samples.html">derivkit.forecasting.getdist_fisher_samples module</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/derivkit.forecasting.laplace.html">derivkit.forecasting.laplace module</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/derivkit.forecasting.priors_core.html">derivkit.forecasting.priors_core module</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/derivkit.forecasting.sampling_utils.html">derivkit.forecasting.sampling_utils module</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="api/derivkit.likelihoods.html">derivkit.likelihoods package</a><input aria-label="Toggle navigation of derivkit.likelihoods package" class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l4"><a class="reference internal" href="api/derivkit.likelihoods.gaussian.html">derivkit.likelihoods.gaussian module</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/derivkit.likelihoods.poisson.html">derivkit.likelihoods.poisson module</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="api/derivkit.utils.html">derivkit.utils package</a><input aria-label="Toggle navigation of derivkit.utils package" class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l4"><a class="reference internal" href="api/derivkit.utils.caching.html">derivkit.utils.caching module</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/derivkit.utils.concurrency.html">derivkit.utils.concurrency module</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/derivkit.utils.extrapolation.html">derivkit.utils.extrapolation module</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/derivkit.utils.linalg.html">derivkit.utils.linalg module</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/derivkit.utils.logger.html">derivkit.utils.logger module</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/derivkit.utils.numerics.html">derivkit.utils.numerics module</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/derivkit.utils.sandbox.html">derivkit.utils.sandbox module</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/derivkit.utils.types.html">derivkit.utils.types module</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/derivkit.utils.validate.html">derivkit.utils.validate module</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="api/derivkit.calculus_kit.html">derivkit.calculus_kit module</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/derivkit.derivative_kit.html">derivkit.derivative_kit module</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/derivkit.forecast_kit.html">derivkit.forecast_kit module</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/derivkit.likelihood_kit.html">derivkit.likelihood_kit module</a></li>
</ul>
</li>
</ul>
</li>
</ul>

</div>
</div>
<div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Branches</span></p>
  <ul>
    <li class="toctree-l1"><a class="reference" href="../main/workflows.html">main</a></li>
  </ul>
  <details>
    <summary class="caption" role="heading"><span class="caption-text">Versions</span></summary>
    <ul>
      <li class="toctree-l1"><a class="reference" href="workflows.html">v1.1.0</a></li>
      <li class="toctree-l1"><a class="reference" href="../v1.0.2/workflows.html">v1.0.2</a></li>
      <li class="toctree-l1"><a class="reference" href="../v1.0.1/workflows.html">v1.0.1</a></li>
      <li class="toctree-l1"><a class="reference" href="../v1.0.0/workflows.html">v1.0.0</a></li>
    </ul>
  </details>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="_sources/workflows.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="dklogo-workflows">
<h1><a class="reference internal" href="_images/logo-black.png"><img alt="DerivKit logo black" src="_images/logo-black.png" style="width: 32px;" /></a> Workflows<a class="headerlink" href="#dklogo-workflows" title="Link to this heading"><span>#</span></a></h1>
<p>This page helps you decide <strong>which DerivKit tool to use</strong> based on your
scientific use case. Each section starts from a concrete question and points
you to the appropriate workflow and examples.</p>
<p>It is intended as a <strong>decision guide</strong>, not a full tutorial.</p>
<p>Using <code class="docutils literal notranslate"><span class="pre">DerivKit</span></code> effectively requires an understanding of the assumptions,
strengths, and limitations of the chosen method. Fisher, DALI, Laplace, and
sampling-based approaches make different approximations and are suited to
different inference regimes. <code class="docutils literal notranslate"><span class="pre">DerivKit</span></code> does not guarantee the validity of any
approximation for a given problem; assessing whether a method is appropriate
for a specific model, parameterization, prior choice, and scientific goal
requires scientific judgment from the user.</p>
<p><code class="docutils literal notranslate"><span class="pre">DerivKit</span></code> does <strong>not</strong> construct data covariances or define scientific models.
Users are expected to provide:</p>
<ul class="simple">
<li><p>their own model mapping parameters to observables</p></li>
<li><p>their own data covariance (or a function returning one)</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">DerivKit</span></code> focuses on derivative evaluation, local likelihood approximations,
and fast forecasting utilities built on top of these inputs.</p>
<p>If you are looking for short answers to common questions, you can jump directly
to the <a class="reference internal" href="#workflows-faq"><span class="std std-ref">FAQ / Frequently asked questions</span></a> section below.
Some common mistakes are discussed in the <a class="reference internal" href="#workflows-mistakes"><span class="std std-ref">Common mistakes</span></a> section.</p>
<section id="quick-decision-guide">
<h2>Quick decision guide<a class="headerlink" href="#quick-decision-guide" title="Link to this heading"><span>#</span></a></h2>
<p>This table provides a fast, high-level guide for choosing a numerical
differentiation strategy in DerivKit. It is intended as a quick reference;
for detailed workflows and examples, see the sections below.</p>
<div class="table-wrapper colwidths-given docutils container">
<table class="docutils align-default">
<colgroup>
<col style="width: 28.0%" />
<col style="width: 28.0%" />
<col style="width: 44.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Situation</strong></p></th>
<th class="head"><p><strong>Recommended method</strong></p></th>
<th class="head"><p><strong>Why</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Smooth, cheap function</p></td>
<td><p>Finite differences</p></td>
<td><p>Fast and accurate for smooth functions</p></td>
</tr>
<tr class="row-odd"><td><p>Slightly noisy function</p></td>
<td><p>Ridders finite differences</p></td>
<td><p>Richardson extrapolation improves stability over simple finite differences</p></td>
</tr>
<tr class="row-even"><td><p>Moderate or structured noise</p></td>
<td><p>Local polynomial fit</p></td>
<td><p>Local regression smooths noise better than finite differences</p></td>
</tr>
<tr class="row-odd"><td><p>High noise / messy signal</p></td>
<td><p>Adaptive polynomial fit (Chebyshev)</p></td>
<td><p>Robust trimming, Chebyshev grid, and fit diagnostics</p></td>
</tr>
<tr class="row-even"><td><p>Expensive function</p></td>
<td><p>Adaptive polynomial fit (Chebyshev)</p></td>
<td><p>Achieves stable derivatives with fewer function evaluations near <code class="docutils literal notranslate"><span class="pre">x0</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Need robustness and diagnostics</p></td>
<td><p>Adaptive polynomial fit (Chebyshev)</p></td>
<td><p>Provides fit quality metrics, degree adjustment, and suggestions</p></td>
</tr>
<tr class="row-even"><td><p>Unsure / first attempt</p></td>
<td><p>Local polynomial fit</p></td>
<td><p>Good default when function behavior is not well known</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="choose-a-workflow">
<h2>Choose a workflow<a class="headerlink" href="#choose-a-workflow" title="Link to this heading"><span>#</span></a></h2>
<section id="i-want-fisher-constraints-on-my-parameters">
<h3>I want Fisher constraints on my parameters<a class="headerlink" href="#i-want-fisher-constraints-on-my-parameters" title="Link to this heading"><span>#</span></a></h3>
<p><strong>You have</strong></p>
<ul class="simple">
<li><p>a parameter vector <code class="docutils literal notranslate"><span class="pre">theta0</span></code></p></li>
<li><p>a model mapping parameters to observables</p></li>
<li><p>a data covariance matrix (or a function returning one)</p></li>
</ul>
<p><strong>We compute</strong></p>
<ul class="simple">
<li><p>the Fisher information matrix</p></li>
<li><p>the Gaussian parameter covariance via inversion</p></li>
<li><p>approximate posterior samples</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">GetDist</span></code>-compatible outputs for visualization</p></li>
</ul>
<p><strong>Use</strong></p>
<ul class="simple">
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ForecastKit.fisher</span></code></p></li>
</ul>
<p><strong>Minimal example</strong></p>
<p>See <a class="reference internal" href="examples/forecasting/fisher.html"><span class="doc"> Fisher matrix</span></a> and <a class="reference internal" href="examples/forecasting/fisher_contours.html"><span class="doc"> Fisher contours</span></a></p>
<p><strong>Notes</strong></p>
<ul class="simple">
<li><p>This assumes the posterior is approximately Gaussian near <code class="docutils literal notranslate"><span class="pre">theta0</span></code>.</p></li>
<li><p>If this assumption fails, consider using DALI instead.</p></li>
<li><p>Parameter-dependent covariances are handled automatically.</p></li>
</ul>
</section>
<section id="i-expect-non-gaussian-posteriors-banana-shaped-skewed-etc">
<h3>I expect non-Gaussian posteriors (banana-shaped, skewed, etc.)<a class="headerlink" href="#i-expect-non-gaussian-posteriors-banana-shaped-skewed-etc" title="Link to this heading"><span>#</span></a></h3>
<p><strong>You have</strong></p>
<ul class="simple">
<li><p>a nonlinear model</p></li>
<li><p>parameters where Fisher may underestimate uncertainties</p></li>
<li><p>parameters with physical bounds or informative priors that truncate the
Gaussian approximation</p></li>
<li><p>a data covariance matrix</p></li>
</ul>
<p><strong>We compute</strong></p>
<ul class="simple">
<li><p>a DALI expansion up to a chosen order:
- order 1: Fisher matrix
- order 2: doublet DALI tensors (D1 and D2)
- order 3: triplet DALI tensors (T1, T2, and T3)</p></li>
<li><p>approximate posterior samples</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">GetDist</span></code>-compatible outputs for visualization</p></li>
</ul>
<p><strong>Use</strong></p>
<ul class="simple">
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ForecastKit.dali(expansion_order=N)</span></code></p></li>
</ul>
<p><strong>Minimal example</strong></p>
<p>See <a class="reference internal" href="examples/forecasting/dali.html"><span class="doc"> DALI tensors</span></a> and <a class="reference internal" href="examples/forecasting/dali_contours.html"><span class="doc"> DALI contours</span></a></p>
<p><strong>Notes</strong></p>
<ul class="simple">
<li><p>Choose the expansion order based on how non-Gaussian you expect the posterior
to be.</p></li>
<li><p>You do not need to manipulate DALI tensors directly.</p></li>
<li><p>Sampling bounds and informative priors can make posteriors non-Gaussian even
when the forward model is close to linear.</p></li>
<li><p>Fisher/DALI describe the <em>likelihood</em> locally; prior truncation effects are
only captured when you sample with explicit priors.</p></li>
</ul>
</section>
<section id="i-already-have-fisher-matrix-dali-tensors-what-do-i-do-next">
<h3>I already have Fisher matrix / DALI tensors. What do I do next?<a class="headerlink" href="#i-already-have-fisher-matrix-dali-tensors-what-do-i-do-next" title="Link to this heading"><span>#</span></a></h3>
<p><strong>You have</strong></p>
<ul class="simple">
<li><p>Fisher <code class="docutils literal notranslate"><span class="pre">F</span></code> and optionally higher-order tensors <code class="docutils literal notranslate"><span class="pre">D1</span></code>, <code class="docutils literal notranslate"><span class="pre">D2</span></code>, …</p></li>
</ul>
<p><strong>We compute</strong></p>
<ul class="simple">
<li><p>approximate posterior samples</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">GetDist</span></code>-compatible outputs for visualization</p></li>
</ul>
<p><strong>Use</strong></p>
<ul class="simple">
<li><p>importance sampling (fast)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">emcee</span></code> sampling (slower, more robust)</p></li>
</ul>
<p><strong>Minimal example</strong></p>
<p>See <a class="reference internal" href="examples/forecasting/dali_contours.html"><span class="doc"> DALI contours</span></a></p>
<p><strong>Notes</strong></p>
<ul class="simple">
<li><p>Importance sampling is extremely fast but may fail for strongly non-Gaussian
posteriors.</p></li>
<li><p>If importance sampling fails, switch to MCMC sampling via <code class="docutils literal notranslate"><span class="pre">emcee</span></code>.</p></li>
</ul>
</section>
<section id="i-want-a-gaussian-approximation-around-a-map">
<h3>I want a Gaussian approximation around a MAP<a class="headerlink" href="#i-want-a-gaussian-approximation-around-a-map" title="Link to this heading"><span>#</span></a></h3>
<p><strong>You have</strong></p>
<ul class="simple">
<li><p>a likelihood or log-posterior</p></li>
<li><p>a maximum a posteriori (MAP) point</p></li>
</ul>
<p><strong>We compute</strong></p>
<ul class="simple">
<li><p>a Laplace (Gaussian) approximation</p></li>
<li><p>an estimate of the local covariance</p></li>
</ul>
<p><strong>Use</strong></p>
<ul class="simple">
<li><p>Laplace approximation utilities</p></li>
</ul>
<p><strong>Minimal example</strong></p>
<p>See <a class="reference internal" href="examples/forecasting/laplace_approx.html"><span class="doc"> Laplace approximation</span></a> and <a class="reference internal" href="examples/forecasting/laplace_contours.html"><span class="doc"> Laplace contours</span></a></p>
<p><strong>Notes</strong></p>
<ul class="simple">
<li><p>The Laplace mean is the expansion point (usually the MAP).</p></li>
<li><p>This is a local approximation and may fail for strongly non-Gaussian posteriors.</p></li>
</ul>
</section>
<section id="i-want-to-include-priors">
<h3>I want to include priors<a class="headerlink" href="#i-want-to-include-priors" title="Link to this heading"><span>#</span></a></h3>
<p><strong>You have</strong></p>
<ul class="simple">
<li><p>prior information (bounds, Gaussian priors, correlated priors, etc.)</p></li>
</ul>
<p><strong>We compute</strong></p>
<ul class="simple">
<li><p>log-prior contributions</p></li>
<li><p>posterior sampling with explicit priors</p></li>
</ul>
<p><strong>Use</strong></p>
<ul class="simple">
<li><p><code class="xref py py-mod docutils literal notranslate"><span class="pre">PriorKit</span></code></p></li>
</ul>
<p><strong>Minimal example</strong></p>
<p>See the DALI sampling examples with priors in <a class="reference internal" href="examples/forecasting/dali_contours.html"><span class="doc"> DALI contours</span></a></p>
<p><strong>Notes</strong></p>
<ul class="simple">
<li><p>Priors are applied explicitly by design.</p></li>
<li><p>Sampler bounds truncate the sampled region; informative priors modify the
posterior shape.</p></li>
</ul>
</section>
<section id="my-model-is-tabulated-or-expensive-to-evaluate">
<h3>My model is tabulated or expensive to evaluate<a class="headerlink" href="#my-model-is-tabulated-or-expensive-to-evaluate" title="Link to this heading"><span>#</span></a></h3>
<p><strong>You have</strong></p>
<ul class="simple">
<li><p>samples of a function on a grid</p></li>
<li><p>no analytic expression (or an expensive forward model)</p></li>
</ul>
<p><strong>We compute</strong></p>
<ul class="simple">
<li><p>numerical derivatives from tabulated data</p></li>
</ul>
<p><strong>Use</strong></p>
<ul class="simple">
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">DerivativeKit</span></code> with <code class="docutils literal notranslate"><span class="pre">x_tab</span></code> and <code class="docutils literal notranslate"><span class="pre">y_tab</span></code> inputs</p></li>
</ul>
<p><strong>Minimal example</strong></p>
<p>See <a class="reference internal" href="examples/derivatives/tabulated.html"><span class="doc"> Tabulated derivatives</span></a></p>
<p><strong>Notes</strong></p>
<ul class="simple">
<li><p>This is especially useful when model evaluations are costly.</p></li>
<li><p>Tabulated models are treated as callables by <code class="docutils literal notranslate"><span class="pre">DerivKit</span></code>.</p></li>
</ul>
</section>
<section id="i-only-want-numerical-derivatives-no-forecasting-yet">
<h3>I only want numerical derivatives (no forecasting yet)<a class="headerlink" href="#i-only-want-numerical-derivatives-no-forecasting-yet" title="Link to this heading"><span>#</span></a></h3>
<p><strong>You have</strong></p>
<ul class="simple">
<li><p>a function or model</p></li>
<li><p>a point where derivatives are needed</p></li>
</ul>
<p><strong>We compute</strong></p>
<ul class="simple">
<li><p>first and higher-order derivatives</p></li>
<li><p>gradients, Jacobians, and Hessians</p></li>
</ul>
<p><strong>Use</strong></p>
<ul class="simple">
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">DerivativeKit</span></code></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">CalculusKit</span></code></p></li>
</ul>
<p><strong>Minimal example</strong></p>
<p>See <a class="reference internal" href="examples/derivatives/index.html"><span class="doc"> Derivatives</span></a></p>
<p><strong>Notes</strong></p>
<ul class="simple">
<li><p>Use <code class="xref py py-class docutils literal notranslate"><span class="pre">CalculusKit</span></code> when you want direct access to gradients/Hessians.</p></li>
<li><p>Use <code class="xref py py-class docutils literal notranslate"><span class="pre">DerivativeKit</span></code> for higher-level derivative workflows and diagnostics.</p></li>
</ul>
</section>
<section id="i-want-fisher-bias-parameter-shifts">
<h3>I want Fisher bias / parameter shifts<a class="headerlink" href="#i-want-fisher-bias-parameter-shifts" title="Link to this heading"><span>#</span></a></h3>
<p><strong>You have</strong></p>
<ul class="simple">
<li><p>a mismatched model and data-generating process</p></li>
<li><p>a Fisher matrix</p></li>
</ul>
<p><strong>We compute</strong></p>
<ul class="simple">
<li><p>parameter bias induced by model mismatch</p></li>
</ul>
<p><strong>Use</strong></p>
<ul class="simple">
<li><p>Fisher bias utilities in <code class="xref py py-class docutils literal notranslate"><span class="pre">ForecastKit</span></code></p></li>
</ul>
<p><strong>Minimal example</strong></p>
<p>See <a class="reference internal" href="examples/forecasting/fisher_bias.html"><span class="doc"> Fisher bias</span></a></p>
</section>
<section id="my-covariance-depends-on-parameters-what-do-i-do">
<h3>My covariance depends on parameters. What do I do?<a class="headerlink" href="#my-covariance-depends-on-parameters-what-do-i-do" title="Link to this heading"><span>#</span></a></h3>
<p><strong>You have</strong></p>
<ul class="simple">
<li><p>a model mapping parameters to observables, and</p></li>
<li><p>a covariance that depends on parameters, <span class="math notranslate nohighlight">\(C(\theta)\)</span>, <strong>or</strong></p></li>
<li><p>noisy inputs and outputs with a block covariance (the X–Y case)</p></li>
</ul>
<p><strong>We compute</strong></p>
<ul class="simple">
<li><p>a <strong>Gaussian Fisher matrix</strong> that includes covariance-derivative terms when
<span class="math notranslate nohighlight">\(C(\theta)\)</span> depends on the parameters</p></li>
<li><p>(optional) X–Y Gaussian Fisher constraints where input uncertainties are
propagated into an effective output covariance</p></li>
</ul>
<p><strong>Use</strong></p>
<ul class="simple">
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">ForecastKit.gaussian_fisher()</span></code> for parameter-dependent covariances</p></li>
<li><p><a class="reference internal" href="api/derivkit.forecasting.fisher_xy.html#derivkit.forecasting.fisher_xy.build_xy_gaussian_fisher_matrix" title="derivkit.forecasting.fisher_xy.build_xy_gaussian_fisher_matrix"><code class="xref py py-func docutils literal notranslate"><span class="pre">derivkit.forecasting.fisher_xy.build_xy_gaussian_fisher_matrix()</span></code></a> for the
X–Y Gaussian case (noisy inputs <em>and</em> outputs)</p></li>
</ul>
<p><strong>Minimal examples</strong></p>
<p>See <a class="reference internal" href="examples/forecasting/fisher_gauss.html"><span class="doc"> Gaussian Fisher matrix</span></a> and
<a class="reference internal" href="examples/forecasting/fisher_xy.html"><span class="doc"> X–Y Gaussian Fisher matrix</span></a>.</p>
<p><strong>Notes</strong></p>
<ul class="simple">
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">ForecastKit.fisher()</span></code> uses a fixed covariance <span class="math notranslate nohighlight">\(C(\theta_0)\)</span> and
computes only the mean-derivative term.</p></li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">ForecastKit.gaussian_fisher()</span></code> adds the covariance-derivative contribution
when a callable covariance <span class="math notranslate nohighlight">\(C(\theta)\)</span> is provided.</p></li>
<li><p>DALI currently assumes a fixed covariance evaluated at <span class="math notranslate nohighlight">\(\theta_0\)</span>;
parameter-dependent covariance support for DALI is planned.</p></li>
</ul>
</section>
<section id="i-have-many-parameters-and-derivative-evaluation-is-expensive">
<h3>I have many parameters and derivative evaluation is expensive<a class="headerlink" href="#i-have-many-parameters-and-derivative-evaluation-is-expensive" title="Link to this heading"><span>#</span></a></h3>
<p><strong>You have</strong></p>
<ul class="simple">
<li><p>a model with many parameters</p></li>
<li><p>expensive function evaluations</p></li>
<li><p>concerns about runtime or scaling</p></li>
</ul>
<p><strong>We compute</strong></p>
<ul class="simple">
<li><p>derivatives using parallel execution</p></li>
<li><p>Jacobians and higher-order tensors efficiently</p></li>
</ul>
<p><strong>Use</strong></p>
<ul class="simple">
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">DerivativeKit</span></code> with <code class="docutils literal notranslate"><span class="pre">n_workers</span></code></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ForecastKit</span></code> parallel derivative evaluation</p></li>
</ul>
<p><strong>Notes</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">DerivKit</span></code> parallelizes derivative evaluations across parameters and outputs.</p></li>
<li><p>This is especially useful for large Fisher or DALI expansions.</p></li>
</ul>
</section>
<section id="i-want-to-compare-fisher-and-dali-forecasts">
<h3>I want to compare Fisher and DALI forecasts<a class="headerlink" href="#i-want-to-compare-fisher-and-dali-forecasts" title="Link to this heading"><span>#</span></a></h3>
<p><strong>You have</strong></p>
<ul class="simple">
<li><p>a Fisher forecast</p></li>
<li><p>a DALI expansion for the same model</p></li>
</ul>
<p><strong>We compute</strong></p>
<ul class="simple">
<li><p>approximate posterior samples from both</p></li>
<li><p>directly comparable contours and summaries</p></li>
</ul>
<p><strong>Use</strong></p>
<ul class="simple">
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ForecastKit.fisher</span></code></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ForecastKit.dali</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">GetDist</span></code>-based visualization utilities</p></li>
</ul>
<p><strong>Notes</strong></p>
<ul class="simple">
<li><p>This is useful for diagnosing non-Gaussianity.</p></li>
<li><p>Differences indicate where Fisher assumptions break down.</p></li>
</ul>
</section>
</section>
<section id="faq-frequently-asked-questions">
<span id="workflows-faq"></span><h2>FAQ / Frequently asked questions<a class="headerlink" href="#faq-frequently-asked-questions" title="Link to this heading"><span>#</span></a></h2>
<p><strong>Why does Fisher underestimate my errors?</strong></p>
<p>Because it assumes the posterior is locally Gaussian. Strong curvature or
parameter degeneracies require higher-order (DALI) terms.</p>
<p><strong>Why is the Laplace mean equal to my expansion point?</strong></p>
<p>The Laplace approximation expands around the MAP by construction. It does not
estimate a shifted mean.</p>
<p><strong>When should I use DALI instead of Fisher?</strong></p>
<p>When the posterior is visibly non-Gaussian or when Fisher forecasts are known
to be biased.</p>
<p><strong>How do I choose the DALI expansion order?</strong></p>
<p>The appropriate expansion order depends on the degree of non-Gaussianity in the
posterior. Order 1 corresponds to the Fisher approximation, while higher orders
capture increasing levels of skewness and curvature. In practice, comparing
results across orders can help diagnose when Fisher assumptions break down.</p>
<p><strong>Why are priors not included automatically?</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">DerivKit</span></code> separates likelihood information from prior assumptions by design.
This keeps approximations explicit and easier to reason about.</p>
<p><strong>Can I use DerivKit with MCMC samplers?</strong></p>
<p>Yes. <code class="docutils literal notranslate"><span class="pre">DerivKit</span></code> likelihoods and priors can be used with any sampler that accepts
log-posterior functions. We provide examples using <code class="docutils literal notranslate"><span class="pre">emcee</span></code> and importance
sampling, but <code class="docutils literal notranslate"><span class="pre">DerivKit</span></code> is sampler-agnostic and can be integrated with other
sampling frameworks by implementing a thin wrapper around the log-posterior API.</p>
<p><strong>Does DerivKit assume Gaussian likelihoods?</strong></p>
<p>No. Fisher and Laplace methods make local Gaussian approximations, while DALI
systematically captures non-Gaussian structure through higher-order terms.</p>
<p><strong>My DALI doublet and triplet contours look identical. Is something wrong?</strong></p>
<p>Usually not. Triplet DALI only modifies the posterior where higher-order
corrections are non-negligible at the typical posterior radius. If most of the
posterior mass lies close to the expansion point <code class="docutils literal notranslate"><span class="pre">theta0</span></code> or if you are using
importance sampling, higher-order terms can be strongly suppressed and contours
may look identical. Remember that DALI is a local expansion: it captures local
skewness and curvature, but cannot reproduce global structure or multiple modes.
For triplet DALI to show significant differences from doublet DALI, the posterior
must extend far enough from <code class="docutils literal notranslate"><span class="pre">theta0</span></code> for cubic terms to become important. We
recommend always using emcee sampling for triplet DALI to fully capture its
effects. If in doubt, compare results across expansion orders and sampling
methods.</p>
<p><strong>Why does DALI behave poorly far from the expansion point?</strong></p>
<p>DALI is based on a Taylor expansion and is only expected to be accurate within a
finite neighborhood around <code class="docutils literal notranslate"><span class="pre">theta0</span></code>. As a result, DALI is not expected to be
accurate for values far away from <code class="docutils literal notranslate"><span class="pre">theta0</span></code>. For this reason, sampling bounds
and diagnostic checks are strongly recommended.</p>
<p><strong>Should I always use the highest DALI expansion order available?</strong></p>
<p>No. Higher-order expansions are more expensive and not always informative.
If increasing the expansion order does not change posterior summaries, lower
orders are usually sufficient and preferable for robustness.</p>
<p><strong>Where do my model and covariance come from?</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">DerivKit</span></code> is agnostic to how models and covariances are constructed. Users are
expected to supply these based on their scientific application, while <code class="docutils literal notranslate"><span class="pre">DerivKit</span></code>
provides derivative evaluation and inference utilities.</p>
<p><strong>Can I use my own likelihood with DerivKit?</strong></p>
<p>Yes. <code class="docutils literal notranslate"><span class="pre">DerivKit</span></code> is agnostic to how likelihoods are defined. Users can supply their
own likelihood or log-posterior functions, which <code class="docutils literal notranslate"><span class="pre">DerivKit</span></code> treats as external
inputs for derivative evaluation, local approximations, and sampling.</p>
<p><strong>Can I use ``DerivKit`` within an existing inference pipeline?</strong></p>
<p>Yes. <code class="docutils literal notranslate"><span class="pre">DerivKit</span></code> is designed to integrate with externally defined models,
likelihoods, and covariances, and can be used alongside other inference or
sampling frameworks.</p>
<p><strong>Are derivatives computed analytically or numerically?</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">DerivKit</span></code> computes derivatives numerically using robust finite-difference and
polynomial-based methods. Optional automatic differentiation backends may be
used for validation, but numerical methods are the default and primary focus.</p>
<p><strong>Where can I find more examples?</strong></p>
<p>See the <a class="reference internal" href="examples/index.html"><span class="doc"> Examples</span></a> section of the documentation.
Additional extended demos are available at
<a class="reference external" href="https://github.com/derivkit/derivkit-demos">https://github.com/derivkit/derivkit-demos</a></p>
<p><strong>Who do I contact for support?</strong></p>
<p>Please open an issue on the <code class="docutils literal notranslate"><span class="pre">DerivKit</span></code> GitHub repository.
Go to <a class="reference internal" href="contributing.html"><span class="doc"> Contributing</span></a> for contribution guidelines and support options.</p>
</section>
<section id="common-mistakes">
<span id="workflows-mistakes"></span><h2>Common mistakes<a class="headerlink" href="#common-mistakes" title="Link to this heading"><span>#</span></a></h2>
<p><strong>Using local approximations for global inference</strong></p>
<p>Fisher, DALI, and Laplace are local approximations around a chosen expansion
point. As such, they may not reliably recover global posterior structure, multiple
modes, or long nonlocal tails beyond the radius of convergence of the local
expansion. If your inference problem is strongly nonlocal,
full MCMC or nested sampling is required.</p>
<p><strong>Expanding around a poorly chosen expansion point</strong></p>
<p>All local methods assume that <code class="docutils literal notranslate"><span class="pre">theta0</span></code> (or the MAP for Laplace) is close to the
region of highest posterior support. Expanding far from the true posterior peak
can lead to misleading forecasts or unstable higher-order corrections.</p>
<p><strong>Relying on importance sampling for strongly non-Gaussian posteriors</strong></p>
<p>Importance sampling is fast but fragile. For curved, skewed, or bounded
posteriors it can severely underestimate higher-order effects. In these cases,
use MCMC sampling (e.g. <code class="docutils literal notranslate"><span class="pre">emcee</span></code>) instead.</p>
<p><strong>Assuming higher-order expansions always improve results</strong></p>
<p>Increasing the DALI expansion order does not guarantee better accuracy. If
higher-order terms are numerically small where the posterior mass lies, results
may be unchanged. Unnecessary higher-order terms can also reduce robustness.</p>
<p><strong>Ignoring sampling bounds and priors</strong></p>
<p>Sampling without explicit bounds or priors can lead to unphysical regions where
local approximations break down. Always include realistic bounds or priors when
sampling Fisher, DALI, or Laplace posteriors.</p>
<p><strong>Expecting priors to be applied automatically</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">DerivKit</span></code> treats likelihood information and priors separately by design. Priors
must be applied explicitly during sampling; they are not combined with Fisher,
DALI, or Laplace objects automatically.</p>
<p><strong>Over-interpreting Laplace approximations</strong></p>
<p>The Laplace approximation provides a Gaussian approximation around the MAP. It
does not capture skewness, curvature, or truncation effects and should not be
used for strongly non-Gaussian posteriors.</p>
<p><strong>Using very tight data covariances without diagnostics</strong></p>
<p>When the posterior is extremely narrow, higher-order corrections can be
numerically suppressed and indistinguishable from Fisher. Always check the
typical posterior radius relative to the expansion point.</p>
<p><strong>Assuming numerical derivatives are exact</strong></p>
<p>All derivatives in <code class="docutils literal notranslate"><span class="pre">DerivKit</span></code> are computed numerically. Poorly scaled parameters,
discontinuous models, or insufficient step-size control can degrade derivative
accuracy. Diagnostic checks are recommended for sensitive applications.</p>
<p><strong>Assuming automatic differentiation is always correct</strong></p>
<p>Automatic differentiation (e.g. <code class="docutils literal notranslate"><span class="pre">JAX</span></code>) can silently fail for non-smooth
models, conditionals, or interpolations; derivative validation is still
recommended, especially for higher-order forecasts.</p>
<p><strong>Confusing likelihood curvature with posterior uncertainty</strong></p>
<p>Fisher, DALI, and Laplace characterize the local curvature of the likelihood.
Posterior uncertainties can differ significantly once priors, bounds, or
nonlinear transformations are applied. Always interpret results in the context
of the full posterior definition.</p>
<p><strong>Using overly informative priors without realizing it</strong></p>
<p>Strong priors can dominate posterior constraints and mask the information
content of the likelihood. When comparing Fisher, DALI, or Laplace results,
check whether constraints are prior-dominated rather than data-driven.</p>
<p><strong>Interpreting Fisher or DALI contours as exact confidence regions</strong></p>
<p>Contours produced from Fisher or DALI approximations are not guaranteed to have
exact frequentist or Bayesian coverage. They should be interpreted as
approximate summaries, not as precise confidence regions.</p>
<p><strong>Mixing Bayesian and frequentist interpretations</strong></p>
<p>Fisher matrices originate from frequentist theory, while posterior sampling and
priors are Bayesian concepts. Mixing interpretations without care can lead to
incorrect conclusions about parameter uncertainties or coverage.</p>
<p><strong>Ignoring parameter reparameterization effects</strong></p>
<p>Local approximations depend on the chosen parameterization. Strong nonlinear
transformations can change the apparent degree of non-Gaussianity and affect
Fisher or DALI performance. Reparameterization may improve stability and
interpretability.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="citation.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title"> Citation</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="examples/likelihoods/poissonian.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title"> Poissonian Likelihood</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, Nikolina Šarčević, Matthijs van der Wild, Cynthia Trendafilova
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#"> Workflows</a><ul>
<li><a class="reference internal" href="#quick-decision-guide">Quick decision guide</a></li>
<li><a class="reference internal" href="#choose-a-workflow">Choose a workflow</a><ul>
<li><a class="reference internal" href="#i-want-fisher-constraints-on-my-parameters">I want Fisher constraints on my parameters</a></li>
<li><a class="reference internal" href="#i-expect-non-gaussian-posteriors-banana-shaped-skewed-etc">I expect non-Gaussian posteriors (banana-shaped, skewed, etc.)</a></li>
<li><a class="reference internal" href="#i-already-have-fisher-matrix-dali-tensors-what-do-i-do-next">I already have Fisher matrix / DALI tensors. What do I do next?</a></li>
<li><a class="reference internal" href="#i-want-a-gaussian-approximation-around-a-map">I want a Gaussian approximation around a MAP</a></li>
<li><a class="reference internal" href="#i-want-to-include-priors">I want to include priors</a></li>
<li><a class="reference internal" href="#my-model-is-tabulated-or-expensive-to-evaluate">My model is tabulated or expensive to evaluate</a></li>
<li><a class="reference internal" href="#i-only-want-numerical-derivatives-no-forecasting-yet">I only want numerical derivatives (no forecasting yet)</a></li>
<li><a class="reference internal" href="#i-want-fisher-bias-parameter-shifts">I want Fisher bias / parameter shifts</a></li>
<li><a class="reference internal" href="#my-covariance-depends-on-parameters-what-do-i-do">My covariance depends on parameters. What do I do?</a></li>
<li><a class="reference internal" href="#i-have-many-parameters-and-derivative-evaluation-is-expensive">I have many parameters and derivative evaluation is expensive</a></li>
<li><a class="reference internal" href="#i-want-to-compare-fisher-and-dali-forecasts">I want to compare Fisher and DALI forecasts</a></li>
</ul>
</li>
<li><a class="reference internal" href="#faq-frequently-asked-questions">FAQ / Frequently asked questions</a></li>
<li><a class="reference internal" href="#common-mistakes">Common mistakes</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=46bd48cc"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f16c4c56"></script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>