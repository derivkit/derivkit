<!doctype html>
<html class="no-js" lang="en" data-content_root="../../">
  <head><meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../genindex.html"><link rel="search" title="Search" href="../../search.html"><link rel="next" title="CalculusKit" href="calculus_kit.html"><link rel="prev" title="Kits" href="index.html">
        <link rel="prefetch" href="../../_static/logos/logo-black.png" as="image">
        <link rel="prefetch" href="../../_static/logos/logo-blue.png" as="image">

    <link rel="shortcut icon" href="../../_static/favicon.png"><!-- Generated with Sphinx 8.2.3 and Furo 2025.12.19 -->
        <title>DerivativeKit - DerivKit documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=d111a655" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=7bdb33bb" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=8dab3a3b" />
    <link rel="stylesheet" type="text/css" href="../../_static/derivkit.css?v=805b2b8a" />
    
    


<style>
  body {
    --color-code-background: #f2f2f2;
  --color-code-foreground: #1e1e1e;
  --color-brand-primary: #3b9ab2;
  --color-brand-content: #3b9ab2;
  --color-link: #3b9ab2;
  --color-link--hover: #f21901;
  --color-link--visited: #e1af00;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #3b9ab2;
  --color-brand-content: #3b9ab2;
  --color-link: #3b9ab2;
  --color-link--hover: #f21901;
  --color-link--visited: #e1af00;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #3b9ab2;
  --color-brand-content: #3b9ab2;
  --color-link: #3b9ab2;
  --color-link--hover: #f21901;
  --color-link--visited: #e1af00;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle site navigation sidebar">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc" aria-label="Toggle table of contents sidebar">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <span class="icon"><svg><use href="#svg-menu"></use></svg></span>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">DerivKit  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../../_static/logos/logo-black.png" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../../_static/logos/logo-blue.png" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text">DerivKit  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="../index.html"> About</a><input aria-label="Toggle navigation of  About" checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../overview.html">What is DerivKit?</a></li>
<li class="toctree-l2 current has-children"><a class="reference internal" href="index.html"> Kits</a><input aria-label="Toggle navigation of  Kits" checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul class="current">
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#"> DerivativeKit</a></li>
<li class="toctree-l3"><a class="reference internal" href="calculus_kit.html"> CalculusKit</a></li>
<li class="toctree-l3"><a class="reference internal" href="forecast_kit.html"> ForecastKit</a></li>
<li class="toctree-l3"><a class="reference internal" href="likelihood_kit.html"> LikelihoodKit</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html"> Installation</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../examples/index.html"> Examples</a><input aria-label="Toggle navigation of  Examples" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../examples/derivatives/index.html"> Derivatives</a><input aria-label="Toggle navigation of  Derivatives" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../examples/derivatives/finite_differences.html"> Finite differences</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/derivatives/adaptive_fit.html"> Adaptive polynomial fit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/derivatives/local_poly.html"> Local polynomial fit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/derivatives/tabulated.html"> Tabulated derivatives</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/derivatives/multiple_points.html"> Derivatives at multiple points</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../examples/calculus/index.html"> Calculus</a><input aria-label="Toggle navigation of  Calculus" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../examples/calculus/gradient.html"> Gradient</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/calculus/jacobian.html"> Jacobian</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/calculus/hessian.html"> Hessian</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/calculus/hyperhessian.html"> Hyper-Hessian</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../examples/forecasting/index.html"> Forecasting</a><input aria-label="Toggle navigation of  Forecasting" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../examples/forecasting/fisher.html"> Fisher matrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/forecasting/fisher_bias.html"> Fisher bias</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/forecasting/dali.html"> DALI tensors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/forecasting/fisher_contours.html"> Fisher contours</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/forecasting/dali_contours.html"> DALI contours</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/forecasting/laplace_approx.html"> Laplace approximation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/forecasting/laplace_contours.html"> Laplace contours</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/forecasting/fisher_gauss.html"> Gaussian Fisher matrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/forecasting/fisher_xy.html"> X–Y Gaussian Fisher matrix</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../examples/likelihoods/index.html"> Likelihoods</a><input aria-label="Toggle navigation of  Likelihoods" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../examples/likelihoods/gaussian.html"> Gaussian Likelihood</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/likelihoods/poissonian.html"> Poissonian Likelihood</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../workflows.html"> Workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../citation.html"> Citation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html"> Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../team.html"> Team</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../license.html"> License</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../api/index.html">derivkit API</a><input aria-label="Toggle navigation of derivkit API" class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../api/derivkit.html">derivkit package</a><input aria-label="Toggle navigation of derivkit package" class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/derivkit.calculus.html">derivkit.calculus package</a><input aria-label="Toggle navigation of derivkit.calculus package" class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/derivkit.calculus.calculus_core.html">derivkit.calculus.calculus_core module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/derivkit.calculus.gradient.html">derivkit.calculus.gradient module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/derivkit.calculus.hessian.html">derivkit.calculus.hessian module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/derivkit.calculus.hyper_hessian.html">derivkit.calculus.hyper_hessian module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/derivkit.calculus.jacobian.html">derivkit.calculus.jacobian module</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/derivkit.derivatives.html">derivkit.derivatives package</a><input aria-label="Toggle navigation of derivkit.derivatives package" class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../api/derivkit.derivatives.adaptive.html">derivkit.derivatives.adaptive package</a><input aria-label="Toggle navigation of derivkit.derivatives.adaptive package" class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../api/derivkit.derivatives.adaptive.adaptive_fit.html">derivkit.derivatives.adaptive.adaptive_fit module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/derivkit.derivatives.adaptive.batch_eval.html">derivkit.derivatives.adaptive.batch_eval module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/derivkit.derivatives.adaptive.diagnostics.html">derivkit.derivatives.adaptive.diagnostics module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/derivkit.derivatives.adaptive.grid.html">derivkit.derivatives.adaptive.grid module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/derivkit.derivatives.adaptive.polyfit_utils.html">derivkit.derivatives.adaptive.polyfit_utils module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/derivkit.derivatives.adaptive.spacing.html">derivkit.derivatives.adaptive.spacing module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/derivkit.derivatives.adaptive.transforms.html">derivkit.derivatives.adaptive.transforms module</a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../api/derivkit.derivatives.autodiff.html">derivkit.derivatives.autodiff package</a><input aria-label="Toggle navigation of derivkit.derivatives.autodiff package" class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../api/derivkit.derivatives.autodiff.jax_autodiff.html">derivkit.derivatives.autodiff.jax_autodiff module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/derivkit.derivatives.autodiff.jax_core.html">derivkit.derivatives.autodiff.jax_core module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/derivkit.derivatives.autodiff.jax_utils.html">derivkit.derivatives.autodiff.jax_utils module</a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../api/derivkit.derivatives.finite.html">derivkit.derivatives.finite package</a><input aria-label="Toggle navigation of derivkit.derivatives.finite package" class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../api/derivkit.derivatives.finite.batch_eval.html">derivkit.derivatives.finite.batch_eval module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/derivkit.derivatives.finite.core.html">derivkit.derivatives.finite.core module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/derivkit.derivatives.finite.extrapolators.html">derivkit.derivatives.finite.extrapolators module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/derivkit.derivatives.finite.finite_difference.html">derivkit.derivatives.finite.finite_difference module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/derivkit.derivatives.finite.stencil.html">derivkit.derivatives.finite.stencil module</a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../api/derivkit.derivatives.local_polynomial_derivative.html">derivkit.derivatives.local_polynomial_derivative package</a><input aria-label="Toggle navigation of derivkit.derivatives.local_polynomial_derivative package" class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../api/derivkit.derivatives.local_polynomial_derivative.diagnostics.html">derivkit.derivatives.local_polynomial_derivative.diagnostics module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/derivkit.derivatives.local_polynomial_derivative.fit.html">derivkit.derivatives.local_polynomial_derivative.fit module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/derivkit.derivatives.local_polynomial_derivative.local_poly_config.html">derivkit.derivatives.local_polynomial_derivative.local_poly_config module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/derivkit.derivatives.local_polynomial_derivative.local_polynomial_derivative.html">derivkit.derivatives.local_polynomial_derivative.local_polynomial_derivative module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/derivkit.derivatives.local_polynomial_derivative.sampling.html">derivkit.derivatives.local_polynomial_derivative.sampling module</a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../api/derivkit.derivatives.tabulated_model.html">derivkit.derivatives.tabulated_model package</a><input aria-label="Toggle navigation of derivkit.derivatives.tabulated_model package" class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../api/derivkit.derivatives.tabulated_model.one_d.html">derivkit.derivatives.tabulated_model.one_d module</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../api/derivkit.derivatives.fornberg.html">derivkit.derivatives.fornberg module</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/derivkit.forecasting.html">derivkit.forecasting package</a><input aria-label="Toggle navigation of derivkit.forecasting package" class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/derivkit.forecasting.dali.html">derivkit.forecasting.dali module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/derivkit.forecasting.expansions.html">derivkit.forecasting.expansions module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/derivkit.forecasting.fisher.html">derivkit.forecasting.fisher module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/derivkit.forecasting.fisher_gaussian.html">derivkit.forecasting.fisher_gaussian module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/derivkit.forecasting.fisher_xy.html">derivkit.forecasting.fisher_xy module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/derivkit.forecasting.forecast_core.html">derivkit.forecasting.forecast_core module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/derivkit.forecasting.getdist_dali_samples.html">derivkit.forecasting.getdist_dali_samples module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/derivkit.forecasting.getdist_fisher_samples.html">derivkit.forecasting.getdist_fisher_samples module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/derivkit.forecasting.laplace.html">derivkit.forecasting.laplace module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/derivkit.forecasting.priors_core.html">derivkit.forecasting.priors_core module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/derivkit.forecasting.sampling_utils.html">derivkit.forecasting.sampling_utils module</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/derivkit.likelihoods.html">derivkit.likelihoods package</a><input aria-label="Toggle navigation of derivkit.likelihoods package" class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/derivkit.likelihoods.gaussian.html">derivkit.likelihoods.gaussian module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/derivkit.likelihoods.poisson.html">derivkit.likelihoods.poisson module</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/derivkit.utils.html">derivkit.utils package</a><input aria-label="Toggle navigation of derivkit.utils package" class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/derivkit.utils.concurrency.html">derivkit.utils.concurrency module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/derivkit.utils.extrapolation.html">derivkit.utils.extrapolation module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/derivkit.utils.linalg.html">derivkit.utils.linalg module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/derivkit.utils.logger.html">derivkit.utils.logger module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/derivkit.utils.numerics.html">derivkit.utils.numerics module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/derivkit.utils.sandbox.html">derivkit.utils.sandbox module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/derivkit.utils.types.html">derivkit.utils.types module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/derivkit.utils.validate.html">derivkit.utils.validate module</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api/derivkit.calculus_kit.html">derivkit.calculus_kit module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/derivkit.derivative_kit.html">derivkit.derivative_kit module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/derivkit.forecast_kit.html">derivkit.forecast_kit module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/derivkit.likelihood_kit.html">derivkit.likelihood_kit module</a></li>
</ul>
</li>
</ul>
</li>
</ul>

</div>
</div>
<div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Branches</span></p>
  <ul>
    <li class="toctree-l1"><a class="reference" href="../../../main/about/kits/derivative_kit.html">main</a></li>
  </ul>
  <details>
    <summary class="caption" role="heading"><span class="caption-text">Versions</span></summary>
    <ul>
      <li class="toctree-l1"><a class="reference" href="../../../v1.1.0/about/kits/derivative_kit.html">v1.1.0</a></li>
      <li class="toctree-l1"><a class="reference" href="../../../v1.0.2/about/kits/derivative_kit.html">v1.0.2</a></li>
      <li class="toctree-l1"><a class="reference" href="derivative_kit.html">v1.0.1</a></li>
      <li class="toctree-l1"><a class="reference" href="../../../v1.0.0/about/kits/derivative_kit.html">v1.0.0</a></li>
    </ul>
  </details>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../../_sources/about/kits/derivative_kit.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="dklogo-derivativekit">
<h1><a class="reference internal" href="../../_images/logo-black.png"><img alt="DerivKit logo black" src="../../_images/logo-black.png" style="width: 32px;" /></a> DerivativeKit<a class="headerlink" href="#dklogo-derivativekit" title="Link to this heading"><span>#</span></a></h1>
<p>DerivKit implements several complementary derivative engines. Each has different
strengths depending on smoothness, noise level, and computational cost.</p>
<p>This page gives an overview of the main methods featured in <code class="docutils literal notranslate"><span class="pre">DerivativeKit</span></code>,
how they work, and when to use each one.</p>
<p>All methods are accessed through the same DerivativeKit interface and can be swapped
without changing downstream code.</p>
<p>Runnable examples illustrating these methods are collected in
<a class="reference internal" href="../../examples/index.html"><span class="doc"> Examples</span></a>.</p>
<section id="finite-differences">
<h2>Finite Differences<a class="headerlink" href="#finite-differences" title="Link to this heading"><span>#</span></a></h2>
<p><strong>How it works:</strong></p>
<p>Estimate derivatives by evaluating the function at points around <code class="docutils literal notranslate"><span class="pre">x0</span></code> and
combining them into a central-difference stencil <a class="footnote-reference brackets" href="#fdiff" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>.</p>
<p>In general, a central finite-difference approximation to the first derivative
can be written as a weighted sum over function evaluations at symmetric offsets
around <code class="docutils literal notranslate"><span class="pre">x0</span></code>:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[f'(x_0) \approx \frac{1}{h} \sum_{k=-m}^{m} c_k\, f(x_0 + k h),\]</div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">h</span></code> is the step size (the spacing between adjacent stencil points),
and the stencil coefficients <code class="docutils literal notranslate"><span class="pre">c_k</span></code> satisfy symmetry conditions
(<code class="docutils literal notranslate"><span class="pre">c_{-k}</span> <span class="pre">=</span> <span class="pre">-c_k</span></code>) and are chosen to cancel low-order truncation errors.
The integer <code class="docutils literal notranslate"><span class="pre">m</span></code> determines the stencil width (e.g. <code class="docutils literal notranslate"><span class="pre">m=1</span></code> for a 3-point
stencil, <code class="docutils literal notranslate"><span class="pre">m=2</span></code> for a 5-point stencil). The coefficients <code class="docutils literal notranslate"><span class="pre">c_k</span></code> are computed
using standard algorithms (such as Fornberg’s method), which construct
finite-difference weights by enforcing the desired order of accuracy for a given stencil.</p>
<p>Higher-order stencils improve accuracy by cancelling additional error terms,
at the cost of more function evaluations.</p>
<p><strong>DerivKit implementation:</strong></p>
<ul class="simple">
<li><p>3, 5, 7, 9-point central stencils</p></li>
<li><p>Richardson extrapolation <a class="footnote-reference brackets" href="#richardsonwiki" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>4<span class="fn-bracket">]</span></a> (reduces truncation error)</p></li>
<li><p>Ridders extrapolation <a class="footnote-reference brackets" href="#ridderswiki" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>5<span class="fn-bracket">]</span></a> (adaptive error control)</p></li>
<li><p>Gauss–Richardson extrapolation (GRE) <a class="footnote-reference brackets" href="#gre" id="id4" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a> (noise-robust variant)</p></li>
</ul>
<p><strong>Use when</strong>:</p>
<ul class="simple">
<li><p>The function is smooth and cheap to evaluate</p></li>
<li><p>Noise is low or absent</p></li>
<li><p>You want fast derivatives with minimal overhead</p></li>
</ul>
<p><strong>Avoid when</strong>:</p>
<ul class="simple">
<li><p>The function is noisy or discontinuous</p></li>
<li><p>Step-size tuning is difficult or unstable</p></li>
<li><p>Function evaluations are expensive</p></li>
</ul>
<p><strong>Examples:</strong></p>
<p>A basic finite-difference example is shown in
<a class="reference internal" href="../../examples/derivatives/finite_differences.html"><span class="doc"> Finite differences</span></a>.</p>
</section>
<section id="simple-polynomial-fit">
<h2>Simple Polynomial Fit<a class="headerlink" href="#simple-polynomial-fit" title="Link to this heading"><span>#</span></a></h2>
<p><strong>How it works:</strong></p>
<p>Sample points in a small, user-controlled window around <code class="docutils literal notranslate"><span class="pre">x0</span></code> and fit a
fixed-order polynomial (e.g. quadratic or cubic) on a simple grid. The
derivative at <code class="docutils literal notranslate"><span class="pre">x0</span></code> is taken from the analytic derivative of the fitted polynomial
<a class="footnote-reference brackets" href="#fornberg" id="id5" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a>.</p>
<p>The expression for a first derivative from a centered quadratic fit</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[p(x) = a_0 + a_1 (x - x_0) + a_2 (x - x_0)^2\]</div>
</div>
<p>is:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[p'(x_0) = a_1,\]</div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">a_1</span></code> is the fitted linear coefficient of the polynomial.</p>
<p><strong>DerivKit implementation:</strong></p>
<ul class="simple">
<li><p>User-chosen window and polynomial degree</p></li>
<li><p>Low overhead and transparent behaviour</p></li>
<li><p>Includes diagnostics on fit quality and conditioning</p></li>
</ul>
<p><strong>Use when</strong>:</p>
<ul class="simple">
<li><p>The function is smooth but mildly noisy</p></li>
<li><p>You want a simple, local smoothing method</p></li>
<li><p>A fixed window and polynomial degree are sufficient</p></li>
</ul>
<p><strong>Avoid when</strong>:</p>
<ul class="simple">
<li><p>Noise is strong or highly irregular</p></li>
<li><p>The fit becomes ill-conditioned in the chosen window</p></li>
</ul>
<p><strong>Examples:</strong></p>
<p>A basic polyfit example is shown in
<a class="reference internal" href="../../examples/derivatives/local_poly.html"><span class="doc"> Local polynomial fit</span></a>.</p>
</section>
<section id="adaptive-polynomial-fit">
<h2>Adaptive Polynomial Fit<a class="headerlink" href="#adaptive-polynomial-fit" title="Link to this heading"><span>#</span></a></h2>
<p><strong>How it works:</strong></p>
<p>Build a Chebyshev-spaced grid around <code class="docutils literal notranslate"><span class="pre">x0</span></code>, rescale offsets to a stable interval,
and fit a local polynomial with optional ridge regularisation.
The method can enlarge the grid if there are too few samples
and adjust the effective polynomial degree.
It also reports detailed diagnostics on fit quality and suggests improvements
if the derivative appears unreliable.
<a class="footnote-reference brackets" href="#fornberg" id="id6" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a>.</p>
<p>For a centered polynomial fit of degree <code class="docutils literal notranslate"><span class="pre">d</span></code>,</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[p(x) = \sum_{k=0}^{d} a_k (x - x_0)^k,\]</div>
</div>
<p>the first derivative is</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[p'(x) = \sum_{k=1}^{d} k\, a_k (x - x_0)^{k-1},\]</div>
</div>
<p>and in particular</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[p'(x_0) = a_1,\]</div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">a_k</span></code> are the fitted polynomial coefficients.</p>
<p>Sampling strategy:</p>
<ul class="simple">
<li><p>Default: symmetric Chebyshev nodes around <code class="docutils literal notranslate"><span class="pre">x0</span></code> with automatic half-width
(via <code class="docutils literal notranslate"><span class="pre">spacing=&quot;auto&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">base_abs</span></code>)</p></li>
<li><p>Domain-aware: interval is clipped to stay inside a given <code class="docutils literal notranslate"><span class="pre">(lo,</span> <span class="pre">hi)</span></code> domain</p></li>
<li><p>Custom grids: user can supply explicit offsets or absolute sample locations</p></li>
</ul>
<p>Below is a visual example of the <code class="xref py py-mod docutils literal notranslate"><span class="pre">derivkit.adaptive_fit</span></code> module estimating
the first derivative of a nonlinear function in the presence of noise. The method
selectively discards outlier points before fitting a polynomial, resulting in a
robust and smooth estimate.</p>
<img alt="../../_images/adaptive_demo_linear_noisy_order1.png" src="../../_images/adaptive_demo_linear_noisy_order1.png" />
<p><strong>DerivKit implementation:</strong></p>
<ul class="simple">
<li><p>Scales offsets before fitting to reduce conditioning</p></li>
<li><p>Optional ridge term to stabilise ill-conditioned Vandermonde systems</p></li>
<li><p>Checks fit quality and flags “obviously bad” derivatives with suggestions for improvement</p></li>
<li><p>Optional diagnostics dictionary with sampled points, fit metrics, and metadata</p></li>
</ul>
<p><strong>Use when</strong>:</p>
<ul class="simple">
<li><p>The function is noisy, irregular, or numerically delicate</p></li>
<li><p>Finite differences or simple polyfits fail</p></li>
<li><p>You want diagnostics to understand derivative quality</p></li>
</ul>
<p><strong>Avoid when</strong>:</p>
<ul class="simple">
<li><p>The function is extremely smooth and cheap to evaluate</p></li>
<li><p>Minimal overhead is a priority</p></li>
<li><p>You want a minimal-overhead solution for very smooth functions</p></li>
</ul>
<p><strong>Examples:</strong></p>
<p>A basic adaptive polyfit example is shown in
<a class="reference internal" href="../../examples/derivatives/adaptive_fit.html"><span class="doc"> Adaptive polynomial fit</span></a>.</p>
</section>
<section id="tabulated-functions">
<h2>Tabulated Functions<a class="headerlink" href="#tabulated-functions" title="Link to this heading"><span>#</span></a></h2>
<p><strong>How it works:</strong></p>
<p>When the target function is provided as tabulated data <code class="docutils literal notranslate"><span class="pre">(x,</span> <span class="pre">y)</span></code>, DerivKit first
wraps the table in a lightweight interpolator and then applies any of the
available derivative engines to the interpolated function.</p>
<p>Internally, tabulated data are represented by
<code class="xref py py-class docutils literal notranslate"><span class="pre">derivkit.tabulated_model.one_d.Tabulated1DModel</span></code>, which exposes a callable
interface compatible with all derivative methods.</p>
<p><strong>DerivKit implementation:</strong></p>
<ul class="simple">
<li><p>Supports scalar-, vector-, and tensor-valued tabulated outputs</p></li>
<li><p>Uses fast linear interpolation via <code class="docutils literal notranslate"><span class="pre">numpy.interp</span></code></p></li>
<li><p>Seamlessly integrates with finite differences, adaptive fit, local polynomial,
and Fornberg methods</p></li>
<li><p>Identical API to function-based differentiation via <code class="xref py py-class docutils literal notranslate"><span class="pre">DerivativeKit</span></code></p></li>
</ul>
<p><strong>Use when:</strong></p>
<ul class="simple">
<li><p>The function is only available as discrete samples</p></li>
<li><p>Evaluating the function on demand is expensive or impossible</p></li>
<li><p>You want to reuse DerivKit’s derivative engines on interpolated data</p></li>
</ul>
<p><strong>Avoid when:</strong></p>
<ul class="simple">
<li><p>The tabulation is too coarse to resolve derivatives</p></li>
<li><p>The function has sharp features not captured by interpolation</p></li>
<li><p>Exact derivatives are required</p></li>
</ul>
<p><strong>Examples:</strong></p>
<p>See <a class="reference internal" href="../../examples/derivatives/tabulated.html"><span class="doc"> Tabulated derivatives</span></a> for a basic example using
tabulated data.</p>
</section>
<section id="jax-autodiff">
<h2>JAX Autodiff<a class="headerlink" href="#jax-autodiff" title="Link to this heading"><span>#</span></a></h2>
<p><strong>How it works:</strong></p>
<p>JAX provides automatic differentiation for Python functions written using
<a class="reference external" href="https://docs.jax.dev/en/latest/jax.numpy.html">jax.numpy</a>. Instead of
estimating derivatives numerically, autodiff propagates
derivatives analytically through the computational graph, yielding exact
derivatives up to machine precision.</p>
<p>A key distinction from finite differences or local fits is that autodiff stays
close to the implemented functional form: it differentiates the same computation
used to produce the model outputs, rather than estimating derivatives from
nearby perturbed evaluations. When the model is smooth and expressed end-to-end
in JAX, the resulting derivative typically has very small numerical error and
does not introduce additional differencing noise.</p>
<p>This avoids step-size choices, local sampling, and numerical differencing.
This does not mean autodiff is universally superior. Autodiff differentiates the
<em>implemented</em> computation. If that computation already contains approximations
(splines, table lookups, iterative solvers, discontinuities, clipping, etc.),
autodiff returns the exact derivative of that effective function, which may not
match the derivative of the intended underlying model.</p>
<p>Its applicability is therefore limited to fully JAX-compatible, analytic models
and does not extend to noisy, interpolated, or externally evaluated functions.</p>
<p><strong>DerivKit implementation:</strong></p>
<ul class="simple">
<li><p>Exposed as an optional reference backend and not registered as a standard
<code class="docutils literal notranslate"><span class="pre">DerivativeKit</span></code> method</p></li>
<li><p>Intended primarily for sanity checks and validation</p></li>
<li><p>Not a core focus of DerivKit, which targets workflows where models are:</p>
<ul>
<li><p>noisy</p></li>
<li><p>tabulated</p></li>
<li><p>interpolated</p></li>
<li><p>externally evaluated</p></li>
<li><p>incompatible with automatic differentiation</p></li>
</ul>
</li>
</ul>
<p><strong>Use when:</strong></p>
<ul class="simple">
<li><p>The function is analytic and fully JAX-compatible</p></li>
<li><p>You want an exact reference derivative for comparison</p></li>
<li><p>You are prototyping or testing derivative workflows</p></li>
</ul>
<p><strong>Avoid when:</strong></p>
<ul class="simple">
<li><p>The function is noisy, tabulated, interpolated, or provided by an external
numerical software (e.g. Boltzmann solvers or many cosmology emulators that
rely on interpolation or precomputed grids rather than end-to-end autodiff)</p></li>
<li><p>You need production robustness or broad applicability</p></li>
<li><p>JAX compatibility cannot be guaranteed</p></li>
</ul>
<p>In most scientific workflows targeted by DerivKit, the adaptive polynomial fit
or finite-difference methods above are more appropriate.</p>
<p>Installation details for the JAX module are described in <a class="reference internal" href="../../installation.html"><span class="doc"> Installation</span></a>.
We do not recommend JAX for production use within DerivKit at this time.</p>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Link to this heading"><span>#</span></a></h2>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="fdiff" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>Wikipedia, <em>Numerical differentiation – Finite differences</em>,
&lt;<a class="reference external" href="https://en.wikipedia.org/wiki/Numerical_differentiation#Finite_differences">https://en.wikipedia.org/wiki/Numerical_differentiation#Finite_differences</a>&gt;</p>
</aside>
<aside class="footnote brackets" id="fornberg" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id5">1</a>,<a role="doc-backlink" href="#id6">2</a>)</span>
<p>B. Fornberg,
<em>High-Accuracy Finite Difference Methods</em>, Cambridge University Press, 2025.
<a class="reference external" href="https://www.cambridge.org/core/books/highaccuracy-finite-difference-methods/F894ADC234A8CCB286DE8C8B43B1E2AA">https://www.cambridge.org/core/books/highaccuracy-finite-difference-methods/F894ADC234A8CCB286DE8C8B43B1E2AA</a></p>
</aside>
<aside class="footnote brackets" id="gre" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id4">3</a><span class="fn-bracket">]</span></span>
<p>C. J. Oates, T. Karvonen, A. L. Teckentrup, M. Strocchi, and S. A. Niederer,
“Probabilistic Richardson Extrapolation”,
<em>arXiv:2401.07562</em>, 2024. <a class="reference external" href="https://arxiv.org/abs/2401.07562">https://arxiv.org/abs/2401.07562</a></p>
</aside>
<aside class="footnote brackets" id="richardsonwiki" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">4</a><span class="fn-bracket">]</span></span>
<p>Wikipedia,
“Richardson extrapolation”,
<a class="reference external" href="https://en.wikipedia.org/wiki/Richardson_extrapolation">https://en.wikipedia.org/wiki/Richardson_extrapolation</a></p>
</aside>
<aside class="footnote brackets" id="ridderswiki" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">5</a><span class="fn-bracket">]</span></span>
<p>Wikipedia,
“Ridders’ method”,
<a class="reference external" href="https://en.wikipedia.org/wiki/Ridders%27_method">https://en.wikipedia.org/wiki/Ridders%27_method</a></p>
</aside>
</aside>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="calculus_kit.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title"> CalculusKit</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title"> Kits</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, Nikolina Šarčević, Matthijs van der Wild, Cynthia Trendafilova
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#"> DerivativeKit</a><ul>
<li><a class="reference internal" href="#finite-differences">Finite Differences</a></li>
<li><a class="reference internal" href="#simple-polynomial-fit">Simple Polynomial Fit</a></li>
<li><a class="reference internal" href="#adaptive-polynomial-fit">Adaptive Polynomial Fit</a></li>
<li><a class="reference internal" href="#tabulated-functions">Tabulated Functions</a></li>
<li><a class="reference internal" href="#jax-autodiff">JAX Autodiff</a></li>
<li><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/furo.js?v=46bd48cc"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f16c4c56"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>