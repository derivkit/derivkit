<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html"><link rel="search" title="Search" href="search.html"><link rel="next" title="derivkit.forecasting.likelihoods module" href="derivkit.forecasting.likelihoods.html"><link rel="prev" title="derivkit.forecasting package" href="derivkit.forecasting.html">

    <link rel="shortcut icon" href="_static/favicon.png"><!-- Generated with Sphinx 8.2.3 and Furo 2025.09.25 -->
        <title>derivkit.forecasting.expansions module - DerivKit documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=d111a655" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=580074bf" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=8dab3a3b" />
    <link rel="stylesheet" type="text/css" href="_static/derivkit.css?v=ed9d9a37" />
    
    


<style>
  body {
    --color-code-background: #f2f2f2;
  --color-code-foreground: #1e1e1e;
  --color-brand-primary: #3b9ab2;
  --color-brand-content: #3b9ab2;
  --color-link: #3b9ab2;
  --color-link--hover: #f21901;
  --color-link--visited: #e1af00;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #3b9ab2;
  --color-brand-content: #3b9ab2;
  --color-link: #3b9ab2;
  --color-link--hover: #f21901;
  --color-link--visited: #e1af00;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #3b9ab2;
  --color-brand-content: #3b9ab2;
  --color-link: #3b9ab2;
  --color-link--hover: #f21901;
  --color-link--visited: #e1af00;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle site navigation sidebar">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc" aria-label="Toggle table of contents sidebar">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <span class="icon"><svg><use href="#svg-menu"></use></svg></span>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">DerivKit  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  <span class="sidebar-brand-text">DerivKit  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="modules.html">derivkit</a><input aria-label="Toggle navigation of derivkit" checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul class="current">
<li class="toctree-l2 current has-children"><a class="reference internal" href="derivkit.html">derivkit package</a><input aria-label="Toggle navigation of derivkit package" checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul class="current">
<li class="toctree-l3 has-children"><a class="reference internal" href="derivkit.adaptive.html">derivkit.adaptive package</a><input aria-label="Toggle navigation of derivkit.adaptive package" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l4"><a class="reference internal" href="derivkit.adaptive.adaptive_fit.html">derivkit.adaptive.adaptive_fit module</a></li>
<li class="toctree-l4"><a class="reference internal" href="derivkit.adaptive.batch_eval.html">derivkit.adaptive.batch_eval module</a></li>
<li class="toctree-l4"><a class="reference internal" href="derivkit.adaptive.diagnostics.html">derivkit.adaptive.diagnostics module</a></li>
<li class="toctree-l4"><a class="reference internal" href="derivkit.adaptive.grid.html">derivkit.adaptive.grid module</a></li>
<li class="toctree-l4"><a class="reference internal" href="derivkit.adaptive.polyfit_utils.html">derivkit.adaptive.polyfit_utils module</a></li>
<li class="toctree-l4"><a class="reference internal" href="derivkit.adaptive.spacing.html">derivkit.adaptive.spacing module</a></li>
<li class="toctree-l4"><a class="reference internal" href="derivkit.adaptive.transforms.html">derivkit.adaptive.transforms module</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="derivkit.calculus.html">derivkit.calculus package</a><input aria-label="Toggle navigation of derivkit.calculus package" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l4"><a class="reference internal" href="derivkit.calculus.gradient.html">derivkit.calculus.gradient module</a></li>
<li class="toctree-l4"><a class="reference internal" href="derivkit.calculus.hessian.html">derivkit.calculus.hessian module</a></li>
<li class="toctree-l4"><a class="reference internal" href="derivkit.calculus.jacobian.html">derivkit.calculus.jacobian module</a></li>
</ul>
</li>
<li class="toctree-l3 current has-children"><a class="reference internal" href="derivkit.forecasting.html">derivkit.forecasting package</a><input aria-label="Toggle navigation of derivkit.forecasting package" checked="" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul class="current">
<li class="toctree-l4 current current-page"><a class="current reference internal" href="#">derivkit.forecasting.expansions module</a></li>
<li class="toctree-l4"><a class="reference internal" href="derivkit.forecasting.likelihoods.html">derivkit.forecasting.likelihoods module</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="derivkit.utils.html">derivkit.utils package</a><input aria-label="Toggle navigation of derivkit.utils package" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l4"><a class="reference internal" href="derivkit.utils.concurrency.html">derivkit.utils.concurrency module</a></li>
<li class="toctree-l4"><a class="reference internal" href="derivkit.utils.linalg.html">derivkit.utils.linalg module</a></li>
<li class="toctree-l4"><a class="reference internal" href="derivkit.utils.numerics.html">derivkit.utils.numerics module</a></li>
<li class="toctree-l4"><a class="reference internal" href="derivkit.utils.sandbox.html">derivkit.utils.sandbox module</a></li>
<li class="toctree-l4"><a class="reference internal" href="derivkit.utils.validate.html">derivkit.utils.validate module</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="derivkit.calculus_kit.html">derivkit.calculus_kit module</a></li>
<li class="toctree-l3"><a class="reference internal" href="derivkit.derivative_kit.html">derivkit.derivative_kit module</a></li>
<li class="toctree-l3"><a class="reference internal" href="derivkit.forecast_kit.html">derivkit.forecast_kit module</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="team.html">Team</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="_sources/derivkit.forecasting.expansions.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="module-derivkit.forecasting.expansions">
<span id="derivkit-forecasting-expansions-module"></span><h1>derivkit.forecasting.expansions module<a class="headerlink" href="#module-derivkit.forecasting.expansions" title="Link to this heading">¶</a></h1>
<p>Provides tools for facilitating experimental forecasts.</p>
<p>The user must specify the observables, fiducial values and covariance matrix
at which the derivative should be evaluated. Derivatives of the first order
are Fisher derivatives. Derivatives of second order are evaluated using the
derivative approximation for likelihoods (DALI) technique as described in
<a class="reference external" href="https://doi.org/10.1103/PhysRevD.107.103506">https://doi.org/10.1103/PhysRevD.107.103506</a>.</p>
<p>More details about available options can be found in the documentation of
the methods.</p>
<dl class="py class">
<dt class="sig sig-object py" id="derivkit.forecasting.expansions.LikelihoodExpansion">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">derivkit.forecasting.expansions.</span></span><span class="sig-name descname"><span class="pre">LikelihoodExpansion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">Buffer</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bytes</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bytes</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">floating</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Buffer</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bytes</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bytes</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Buffer</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bytes</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bytes</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#derivkit.forecasting.expansions.LikelihoodExpansion" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Provides tools for facilitating experimental forecasts.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="derivkit.forecasting.expansions.LikelihoodExpansion.function">
<span class="sig-name descname"><span class="pre">function</span></span><a class="headerlink" href="#derivkit.forecasting.expansions.LikelihoodExpansion.function" title="Link to this definition">¶</a></dt>
<dd><p>The scalar or vector-valued function to
differentiate. It should accept a list or array of parameter
values as input and return either a scalar or a
<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code> of observable values.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="derivkit.forecasting.expansions.LikelihoodExpansion.theta0">
<span class="sig-name descname"><span class="pre">theta0</span></span><a class="headerlink" href="#derivkit.forecasting.expansions.LikelihoodExpansion.theta0" title="Link to this definition">¶</a></dt>
<dd><p>The point(s) at which the
derivative is evaluated. A 1D array or list of parameter values
matching the expected input of the function.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="derivkit.forecasting.expansions.LikelihoodExpansion.cov">
<span class="sig-name descname"><span class="pre">cov</span></span><a class="headerlink" href="#derivkit.forecasting.expansions.LikelihoodExpansion.cov" title="Link to this definition">¶</a></dt>
<dd><p>The covariance matrix of
the observables. Should be a square matrix with shape
(n_observables, n_observables), where n_observables is the
number of observables returned by the function.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="derivkit.forecasting.expansions.LikelihoodExpansion.n_parameters">
<span class="sig-name descname"><span class="pre">n_parameters</span></span><a class="headerlink" href="#derivkit.forecasting.expansions.LikelihoodExpansion.n_parameters" title="Link to this definition">¶</a></dt>
<dd><p>The number of elements of <cite>theta0</cite>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="derivkit.forecasting.expansions.LikelihoodExpansion.n_observables">
<span class="sig-name descname"><span class="pre">n_observables</span></span><a class="headerlink" href="#derivkit.forecasting.expansions.LikelihoodExpansion.n_observables" title="Link to this definition">¶</a></dt>
<dd><p>The number of cosmic observables. Determined
from the dimension of <cite>cov</cite>.</p>
</dd></dl>

<p>Initialises the class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function</strong> – The scalar or vector-valued function to
differentiate. It should accept a list or array of parameter
values as input and return either a scalar or a
<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code> of observable values.</p></li>
<li><p><strong>theta0</strong> – The points at which the
derivative is evaluated. A 1D array or list of parameter values
matching the expected input of the function.</p></li>
<li><p><strong>cov</strong> – The covariance matrix of the observables. Should be a square
matrix with shape (n_observables, n_observables), where n_observables
is the number of observables returned by the function.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – raised if cov is not a square numpy array.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="derivkit.forecasting.expansions.LikelihoodExpansion.build_delta_nu">
<span class="sig-name descname"><span class="pre">build_delta_nu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">data_with:</span> <span class="pre">~numpy.ndarray[tuple[~typing.Any,</span> <span class="pre">...],</span> <span class="pre">~numpy.dtype[~numpy.floating]],</span> <span class="pre">data_without:</span> <span class="pre">~numpy.ndarray[tuple[~typing.Any,</span> <span class="pre">...],</span> <span class="pre">~numpy.dtype[~numpy.floating]],</span> <span class="pre">*,</span> <span class="pre">dtype:</span> <span class="pre">type</span> <span class="pre">|</span> <span class="pre">~numpy.dtype</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'float'&gt;</span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">floating</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#derivkit.forecasting.expansions.LikelihoodExpansion.build_delta_nu" title="Link to this definition">¶</a></dt>
<dd><p>Compute the difference between two data vectors.</p>
<p>This function is typically used for Fisher-bias estimates, taking two data vectors—
one with a systematic included and one without—and returning their difference as a
1D array that matches the expected number of observables in this instance. It works
with both 1D inputs and 2D arrays (for example, correlation × ell) and flattens 2D
arrays using NumPy’s row-major (“C”) order, our standard convention throughout the package.</p>
<p>We standardize on row-major (“C”) flattening of 2D arrays, where the last
axis varies fastest. The user must ensure that any data vectors and associated covariances
are constructed with the same convention for consistent results.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_with</strong> – Data vector that includes the systematic effect. Can be 1D or 2D.
If 1D, it must follow the NumPy’s row-major (“C”) flattening convention used
throughout the package.</p></li>
<li><p><strong>data_without</strong> – Reference data vector without the systematic. Can be 1D or 2D. If 1D,
it must follow the NumPy’s row-major (“C”) flattening convention used throughout
the package.</p></li>
<li><p><strong>dtype</strong> – Data type of the output array (defaults to float).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A 1D NumPy array of length <code class="docutils literal notranslate"><span class="pre">self.n_observables</span></code> representing the data
mismatch (delta_nu = data_with − data_without).</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ValueError</strong> – If input shapes differ, inputs are not 1D/2D, or the flattened
    length does not match <code class="docutils literal notranslate"><span class="pre">self.n_observables</span></code>.</p></li>
<li><p><strong>FloatingPointError</strong> – If non-finite values are detected in the result.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="derivkit.forecasting.expansions.LikelihoodExpansion.build_fisher_bias">
<span class="sig-name descname"><span class="pre">build_fisher_bias</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fisher_matrix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">floating</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta_nu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">floating</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dk_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rcond</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-12</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">floating</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">floating</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#derivkit.forecasting.expansions.LikelihoodExpansion.build_fisher_bias" title="Link to this definition">¶</a></dt>
<dd><p>Estimate parameter bias using the stored model, expansion point, and covariance.</p>
<p>This method quantifies how differences between two data sets (for example,
a fiducial prediction and one affected by a systematic) propagate into
parameter biases when interpreted through a Fisher forecast. It evaluates
the model response internally and uses it, together with the stored
covariance and provided Fisher matrix, to estimate both the bias vector
and the resulting shift in parameter values.
For more information, see <a class="reference external" href="https://arxiv.org/abs/0710.5171">https://arxiv.org/abs/0710.5171</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fisher_matrix</strong> – Square matrix describing information about the parameters.
Its shape must be (p, p), where p is the number of parameters.</p></li>
<li><p><strong>delta_nu</strong> – Difference between two data vectors (for example, with and without
a systematic). Accepts a 1D array of length n or a 2D array that will be
flattened in row-major order (“C”) to length n, where n is the number of observables.
If supplied as a 1D array, it must already follow the same row-major (“C”)
flattening convention used throughout the package.</p></li>
<li><p><strong>n_workers</strong> – Number of workers used by the internal derivative routine when
forming the Jacobian.</p></li>
<li><p><strong>method</strong> – Method name or alias (e.g., “adaptive”, “finite”).
If None, the DerivativeKit default (“adaptive”) is used.</p></li>
<li><p><strong>dk_kwargs</strong> – Additional keyword arguments passed to DerivativeKit.differentiate.</p></li>
<li><p><strong>rcond</strong> – Regularization cutoff for pseudoinverse. Default is 1e-12.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>bias_vec: parameter-space bias vector.</p></li>
<li><p>delta_theta: estimated parameter shifts.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>A tuple <code class="docutils literal notranslate"><span class="pre">(bias_vec,</span> <span class="pre">delta_theta)</span></code> where both entries are 1D arrays of length <code class="docutils literal notranslate"><span class="pre">p</span></code></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If input shapes are inconsistent with the stored model, covariance,
    or the Fisher matrix dimensions.</p></li>
<li><p><strong>FloatingPointError</strong> – If the difference vector contains NaNs.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="derivkit.forecasting.expansions.LikelihoodExpansion.get_forecast_tensors">
<span class="sig-name descname"><span class="pre">get_forecast_tensors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">forecast_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dk_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#derivkit.forecasting.expansions.LikelihoodExpansion.get_forecast_tensors" title="Link to this definition">¶</a></dt>
<dd><p>Returns a set of tensors according to the requested order of the forecast.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>forecast_order</strong> – <p>The requested order D of the forecast:</p>
<blockquote>
<div><ul>
<li><p>D = 1 returns a Fisher matrix.</p></li>
<li><p>D = 2 returns the 3-d and 4-d tensors required for the
doublet-DALI approximation.</p></li>
<li><p>D = 3 would be the triplet-DALI approximation.</p></li>
</ul>
</div></blockquote>
<p>Currently only D = 1, 2 are supported.</p>
</p></li>
<li><p><strong>method</strong> – Method name or alias (e.g., “adaptive”, “finite”). If None,
the DerivativeKit default (“adaptive”) is used.</p></li>
<li><p><strong>n_workers</strong> – Number of workers for per-parameter parallelization/threads.
Default 1 (serial). Inner batch evaluation is kept serial to avoid
nested pools.</p></li>
<li><p><strong>dk_kwargs</strong> – Additional keyword arguments passed to DerivativeKit.differentiate.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Fisher matrix of shape <code class="docutils literal notranslate"><span class="pre">(P,</span> <span class="pre">P)</span></code>.
If <code class="docutils literal notranslate"><span class="pre">D</span> <span class="pre">=</span> <span class="pre">2</span></code>: tuple <code class="docutils literal notranslate"><span class="pre">(G,</span> <span class="pre">H)</span></code> with shapes <code class="docutils literal notranslate"><span class="pre">(P,</span> <span class="pre">P,</span> <span class="pre">P)</span></code> and <code class="docutils literal notranslate"><span class="pre">(P,</span> <span class="pre">P,</span> <span class="pre">P,</span> <span class="pre">P)</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>If <code class="docutils literal notranslate"><span class="pre">D</span> <span class="pre">=</span> <span class="pre">1</span></code></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If <cite>forecast_order</cite> is not 1 or 2.</p>
</dd>
<dt class="field-odd">Warns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>RuntimeWarning</strong> – If <cite>cov</cite> is not symmetric (proceeds as-is, no symmetrization),
is ill-conditioned (large condition number), or inversion
falls back to the pseudoinverse.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="derivkit.forecasting.expansions.mixed_partial_path">
<span class="sig-prename descclassname"><span class="pre">derivkit.forecasting.expansions.</span></span><span class="sig-name descname"><span class="pre">mixed_partial_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">function</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dk_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="headerlink" href="#derivkit.forecasting.expansions.mixed_partial_path" title="Link to this definition">¶</a></dt>
<dd><p>Compute a first derivative while temporarily fixing another parameter.</p>
<p>This helper builds a single-argument path where parameter <code class="docutils literal notranslate"><span class="pre">j</span></code> is set to
the provided value and all other parameters are held at the expansion
point. Along that path it evaluates the first derivative of the model with
respect to parameter <code class="docutils literal notranslate"><span class="pre">i</span></code>. It is used to construct mixed second
derivatives without nested function definitions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> – Value to assign to parameter <code class="docutils literal notranslate"><span class="pre">j</span></code> along the evaluation path.</p></li>
<li><p><strong>function</strong> – Model function that returns a vector of observables given a
parameter vector.</p></li>
<li><p><strong>theta0</strong> – Parameter vector at the expansion point.</p></li>
<li><p><strong>i</strong> – Index of the parameter to differentiate with respect to.</p></li>
<li><p><strong>j</strong> – Index of the parameter that is temporarily set to <code class="docutils literal notranslate"><span class="pre">y</span></code>.</p></li>
<li><p><strong>method</strong> – Derivative method to use, such as “adaptive” or “finite”. If
None, the DerivativeKit default is used.</p></li>
<li><p><strong>dk_kwargs</strong> – Extra keyword arguments forwarded to
DerivativeKit.differentiate.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A one-dimensional array with the first derivative of each observable
with respect to parameter <code class="docutils literal notranslate"><span class="pre">i</span></code> evaluated at the path where parameter
<code class="docutils literal notranslate"><span class="pre">j</span></code> equals <code class="docutils literal notranslate"><span class="pre">y</span></code>.</p>
</dd>
</dl>
</dd></dl>

</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="derivkit.forecasting.likelihoods.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">derivkit.forecasting.likelihoods module</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="derivkit.forecasting.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">derivkit.forecasting package</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, Nikolina Šarčević, Matthijs van der Wild, Cynthia Trendafilova
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">derivkit.forecasting.expansions module</a><ul>
<li><a class="reference internal" href="#derivkit.forecasting.expansions.LikelihoodExpansion"><code class="docutils literal notranslate"><span class="pre">LikelihoodExpansion</span></code></a><ul>
<li><a class="reference internal" href="#derivkit.forecasting.expansions.LikelihoodExpansion.function"><code class="docutils literal notranslate"><span class="pre">LikelihoodExpansion.function</span></code></a></li>
<li><a class="reference internal" href="#derivkit.forecasting.expansions.LikelihoodExpansion.theta0"><code class="docutils literal notranslate"><span class="pre">LikelihoodExpansion.theta0</span></code></a></li>
<li><a class="reference internal" href="#derivkit.forecasting.expansions.LikelihoodExpansion.cov"><code class="docutils literal notranslate"><span class="pre">LikelihoodExpansion.cov</span></code></a></li>
<li><a class="reference internal" href="#derivkit.forecasting.expansions.LikelihoodExpansion.n_parameters"><code class="docutils literal notranslate"><span class="pre">LikelihoodExpansion.n_parameters</span></code></a></li>
<li><a class="reference internal" href="#derivkit.forecasting.expansions.LikelihoodExpansion.n_observables"><code class="docutils literal notranslate"><span class="pre">LikelihoodExpansion.n_observables</span></code></a></li>
<li><a class="reference internal" href="#derivkit.forecasting.expansions.LikelihoodExpansion.build_delta_nu"><code class="docutils literal notranslate"><span class="pre">LikelihoodExpansion.build_delta_nu()</span></code></a></li>
<li><a class="reference internal" href="#derivkit.forecasting.expansions.LikelihoodExpansion.build_fisher_bias"><code class="docutils literal notranslate"><span class="pre">LikelihoodExpansion.build_fisher_bias()</span></code></a></li>
<li><a class="reference internal" href="#derivkit.forecasting.expansions.LikelihoodExpansion.get_forecast_tensors"><code class="docutils literal notranslate"><span class="pre">LikelihoodExpansion.get_forecast_tensors()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#derivkit.forecasting.expansions.mixed_partial_path"><code class="docutils literal notranslate"><span class="pre">mixed_partial_path()</span></code></a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=46bd48cc"></script>
    </body>
</html>